{% extends 'generic/form_mixin.html' %}
{% load static %}

{% block title %}Mi Perfil{% endblock %}

{% block form %}
<div class="p-4 sm:p-8 space-y-8">
    <!-- Información Personal -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-neutral-100">
        <h3 class="text-lg font-semibold text-neutral-800 mb-5 flex items-center border-b border-neutral-100 pb-3">
            <span class="w-8 h-8 bg-primary-50 text-primary-600 rounded-lg flex items-center justify-center mr-3">
                <i class="fas fa-user-circle"></i>
            </span>
            Información Personal
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
            <!-- Nombres -->
            <div class="form-group">
                <label for="{{ form.first_name.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Nombres <span class="text-danger-500">*</span>
                </label>
                {{ form.first_name }}
                {% if form.first_name.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.first_name.errors }}</div>
                {% endif %}
            </div>
            
            <!-- Apellidos -->
            <div class="form-group">
                <label for="{{ form.last_name.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Apellidos <span class="text-danger-500">*</span>
                </label>
                {{ form.last_name }}
                {% if form.last_name.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.last_name.errors }}</div>
                {% endif %}
            </div>
            
            <!-- Email -->
            <div class="form-group md:col-span-2">
                <label for="{{ form.email.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Correo electrónico <span class="text-danger-500">*</span>
                </label>
                {{ form.email }}
                {% if form.email.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.email.errors }}</div>
                {% endif %}
                <p class="text-xs text-neutral-500 mt-1">Este correo se utilizará para iniciar sesión en el sistema</p>
            </div>
            
            <!-- DNI/Cédula -->
            <div class="form-group">
                <label for="{{ form.dni.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Cédula/DNI
                </label>
                {{ form.dni }}
                {% if form.dni.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.dni.errors }}</div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Información de Contacto -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-neutral-100">
        <h3 class="text-lg font-semibold text-neutral-800 mb-5 flex items-center border-b border-neutral-100 pb-3">
            <span class="w-8 h-8 bg-accent-50 text-accent-600 rounded-lg flex items-center justify-center mr-3">
                <i class="fas fa-address-card"></i>
            </span>
            Información de Contacto
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
            <!-- Teléfono -->
            <div class="form-group">
                <label for="{{ form.phone.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Teléfono
                </label>
                {{ form.phone }}
                {% if form.phone.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.phone.errors }}</div>
                {% endif %}
            </div>
            
            <!-- Dirección -->
            <div class="form-group md:col-span-2">
                <label for="{{ form.direction.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Dirección
                </label>
                {{ form.direction }}
                {% if form.direction.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.direction.errors }}</div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Imagen de Perfil -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-neutral-100">
        <h3 class="text-lg font-semibold text-neutral-800 mb-5 flex items-center border-b border-neutral-100 pb-3">
            <span class="w-8 h-8 bg-secondary-50 text-secondary-600 rounded-lg flex items-center justify-center mr-3">
                <i class="fas fa-image"></i>
            </span>
            Imagen de Perfil
        </h3>
        
        <div class="flex flex-col md:flex-row items-start md:items-center gap-5">
            <!-- Imagen actual -->
            <div class="flex-shrink-0">
                {% if user.image %}
                    <div class="w-24 h-24 rounded-full overflow-hidden bg-neutral-100 shadow-sm">
                        <img src="{{ user.image.url }}" alt="Imagen de perfil" class="w-full h-full object-cover">
                    </div>
                {% else %}
                    <div class="w-24 h-24 bg-gradient-to-br from-primary-400 to-accent-600 rounded-full flex items-center justify-center shadow-sm">
                        <span class="text-white font-bold text-xl">{{ user.username|slice:":2"|upper }}</span>
                    </div>
                {% endif %}
            </div>
            
            <!-- Input de imagen -->
            <div class="flex-grow">
                <label for="{{ form.image.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Cambiar imagen de perfil
                </label>
                {{ form.image }}
                {% if form.image.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.image.errors }}</div>
                {% endif %}
                <p class="text-xs text-neutral-500 mt-1">Formatos recomendados: JPG, PNG o GIF (máx. 2MB)</p>
            </div>
        </div>
    </div>
    
    <!-- Contraseña -->
    <div class="bg-white rounded-xl p-6 shadow-sm border border-neutral-100">
        <h3 class="text-lg font-semibold text-neutral-800 mb-5 flex items-center border-b border-neutral-100 pb-3">
            <span class="w-8 h-8 bg-warning-50 text-warning-600 rounded-lg flex items-center justify-center mr-3">
                <i class="fas fa-lock"></i>
            </span>
            Cambiar Contraseña
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
            <!-- Nueva contraseña -->
            <div class="form-group">
                <label for="{{ form.password1.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Nueva contraseña
                </label>
                {{ form.password1 }}
                {% if form.password1.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.password1.errors }}</div>
                {% endif %}
                <p class="text-xs text-neutral-500 mt-1">Deje en blanco para mantener la contraseña actual</p>
            </div>
            
            <!-- Confirmar contraseña -->
            <div class="form-group">
                <label for="{{ form.password2.id_for_label }}" class="text-sm font-semibold text-neutral-700 mb-2 block">
                    Confirmar nueva contraseña
                </label>
                {{ form.password2 }}
                {% if form.password2.errors %}
                    <div class="text-xs text-danger-600 mt-1">{{ form.password2.errors }}</div>
                {% endif %}
            </div>
        </div>
    </div>
    
    {% if form.non_field_errors %}
    <div class="bg-danger-50 border border-danger-200 rounded-lg p-4 text-danger-800">
        <div class="flex items-center">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-circle text-danger-500"></i>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-danger-800">Hay errores en el formulario</h3>
                <div class="mt-2 text-sm text-danger-700">
                    <ul class="list-disc pl-5 space-y-1">
                        {% for error in form.non_field_errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}